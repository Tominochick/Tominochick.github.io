<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>&#39;çˆ¬è™«ä¸‹è½½bç«™è§†é¢‘&#39;</title>
    <url>/2020/04/28/%E7%88%AC%E8%99%AB%E4%B8%8B%E8%BD%BDb%E7%AB%99%E8%A7%86%E9%A2%91/</url>
    <content><![CDATA[<p>è‡ªå·±ç»ƒä¹ ç½‘ä¸ŠæŠ“ä¸œè¥¿ã€‚<br><br><br>å®ç°åŠŸèƒ½ï¼šæ£€ç´¢ã€ä¸‹è½½bç«™<strong>éä¼šå‘˜</strong>è§†é¢‘ã€‚<br><br>æ ¸å¿ƒéƒ¨åˆ†ï¼šå¯¹bç«™å…¬å…±apiçš„ä½¿ç”¨ï¼Œä¹Ÿè®©æˆ‘å¯¹ä»€ä¹ˆæ˜¯apiæœ‰äº†ä¸€å®šçš„äº†è§£ã€‚<br><br>ç¨‹åºè®¾è®¡æ€è·¯ï¼šè·å¾—bvidâ†’è·å¾—cidâ†’è·å¾—è§†é¢‘urlâ†’ä¸‹è½½flv<br><br>æ„Ÿæƒ³ï¼šä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œæ„Ÿè§‰è¿™éƒ½æ˜¯ä¸€äº›è¡¨é¢çš„ä¸œè¥¿ï¼Œæ²¡ä»€ä¹ˆå®è´¨çš„æŠ€æœ¯å«é‡ï¼Œä¹Ÿè®¸æ˜¯è‡ªå·±ç°åœ¨è¿˜æ¯”è¾ƒèœï¼Œä¹Ÿç®—æ˜¯åŸºç¡€å…¥é—¨å§ã€‚<br><br>éš¾ç‚¹ï¼š <strong>æ­£åˆ™è¡¨è¾¾å¼</strong>çš„ä½¿ç”¨ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘è§‰å¾—æ¯”è¾ƒéš¾çš„åœ°æ–¹å§ã€‚æˆ‘ä¹Ÿæƒ³è¿‡ç”¨beautifulsoup4ï¼Œå°è¯•äº†ä¸€ä¸‹æ”¾å¼ƒäº†ï¼Œå› ä¸ºbs4è¿˜æ˜¯è¦ç”¨åˆ°æ­£åˆ™ï¼ˆä¸»è¦æ˜¯æˆ‘è¿˜æ²¡å­¦é€ï¼‰ï¼Œ<br><br><br>&emsp;&emsp;ä¹‹åæˆ‘ä¼šæ›´å¤šçš„æŠ•å…¥åˆ°å¤§å­¦åŸºç¡€è¯¾ç¨‹çš„å­¦ä¹ ã€‚å•Šï¼ä¿ºçš„é«˜æ•°ï¼Œå•Šï¼ä¿ºçš„Englishï¼Œä¿ºæ¥å•¦~<br><br>æ­£æ–‡ï¼šå†™è¿™ç¯‡æ–‡ç« ä¸»è¦æ˜¯æƒ³æ€»ç»“ä¸€ä¸‹ï¼Œä¸€äº›éš¾ç‚¹ï¼Œå¿ƒå¾—ã€‚<br><br>æ„Ÿè°¢ï¼šBilibili ORZ</p>
<a id="more"></a>
<h1 id="1ã€èµ„æºè·å–"><a href="#1ã€èµ„æºè·å–" class="headerlink" title="1ã€èµ„æºè·å–"></a>1ã€èµ„æºè·å–<br></h1><p>&emsp;bç«™å¯¹è§†é¢‘èµ„æºè®¾è®¡æ˜¯æœ‰äº†bvidï¼ˆavidï¼‰è§†é¢‘IDå’Œcvidè§†é¢‘åˆ†æ®µIDï¼ˆå°±æ˜¯â€œè‡ªå¤2pæ²¡äººçœ‹çš„â€˜pâ€™ â€ï¼‰å°±èƒ½ä»bç«™apiè·å–è§†é¢‘urlï¼Œç”¨è¿™ä¸ªurlå°±èƒ½ä»bç«™æœåŠ¡å™¨ä¸‹è½½è§†é¢‘ã€‚<br><br></p>
<h2 id="1-1-è·å¾—bvid"><a href="#1-1-è·å¾—bvid" class="headerlink" title="1.1 è·å¾—bvid"></a><strong>1.1 è·å¾—bvid</strong><br></h2><p>ä»bç«™çš„searchæœåŠ¡å™¨ç½‘ç«™â€™<a href="https://search.bilibili.com/all?keyword=&#39;" target="_blank" rel="noopener">https://search.bilibili.com/all?keyword=&#39;</a><br><br>â€˜keyword=â€™åœ¨åé¢åŠ ä¸Šæƒ³è¦æœç´¢çš„åç§°<br><br>å°±èƒ½å¾—åˆ°ç´¢å¼•<a href="https://baike.baidu.com/item/HTML/97049?fr=aladdin" target="_blank" rel="noopener">html</a>æ–‡æ¡£ã€‚ç”¨æ­£åˆ™è¡¨è¾¾å¼æå–æ–‡æ¡£ä¸­bvidã€è§†é¢‘åå­—å’Œè¯¥è§†é¢‘çš„urlï¼ˆä»¥åheaderså¤´ä¸­refererè¦ç”¨ï¼Œé˜²æ­¢åçˆ¬ï¼‰</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pattern = compile(<span class="string">'&lt;a href="//www.bilibili.com(.*)" title="(.*?)" '</span>)<span class="comment"># è·å–Bvidã€è§†é¢‘åå­—</span></span><br><span class="line">data = re.findall(patten, html)<span class="comment"># æ­£åˆ™åŒ¹é… </span></span><br><span class="line"></span><br><span class="line">list = []<span class="comment"># ç”¨æ¥ä¿å­˜ç”± åºå·ã€åå­—ã€bvidã€refereræ„æˆçš„å­—å…¸1</span></span><br><span class="line">        i = <span class="number">0</span> </span><br><span class="line">        <span class="keyword">for</span> ul, name <span class="keyword">in</span> data:</span><br><span class="line">            dict = &#123;<span class="string">'number'</span>: <span class="string">''</span>, <span class="string">'name'</span>: <span class="string">''</span>, <span class="string">'bvid'</span>: <span class="string">''</span>, <span class="string">'referer'</span>: <span class="string">''</span>&#125;</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">            referer = <span class="string">'http://www.bilibili.com'</span> + ul</span><br><span class="line">            bvid = re.findall(<span class="string">'/([a-zA-Z0-9]*)\?'</span>, ul)[<span class="number">0</span>]</span><br><span class="line">            dict[<span class="string">'number'</span>] = i</span><br><span class="line">            dict[<span class="string">'name'</span>] = name</span><br><span class="line">            dict[<span class="string">'bvid'</span>] = bvid</span><br><span class="line">            dict[<span class="string">'referer'</span>] = referer</span><br><span class="line">            list.append(dict)</span><br><span class="line">        path = savefile.save(name=s_name, dirpath=root_dir, content=list, suffix=<span class="string">'json'</span>)</span><br><span class="line">        <span class="comment"># æˆ‘ä¸ºäº†æ›´å¥½çš„æµ‹è¯•ï¼Œå°†æ¯ä¸€æ­¥çš„ç»“æœéƒ½ä¿å­˜äº†èµ·æ¥ï¼Œè¿™ä¸ªsavefileå‡½æ•°æ˜¯æˆ‘è‡ªå·±å†™çš„ã€‚</span></span><br></pre></td></tr></table></figure>
<h2 id="1-2è·å–cid"><a href="#1-2è·å–cid" class="headerlink" title="1.2è·å–cid"></a><strong>1.2è·å–cid</strong><br></h2><p>ä»bç«™çš„apiâ€<a href="https://api.bilibili.com/x/player/pagelist?bvid=BV1C7411k7D3&amp;jsonp=jsonp&quot;è·å¾—cid" target="_blank" rel="noopener">https://api.bilibili.com/x/player/pagelist?bvid=BV1C7411k7D3&amp;jsonp=jsonp&quot;è·å¾—cid</a><br><br>â€˜bvid=â€™åé¢åŠ ä¸Šè·å¾—çš„bvidå°±å¯ä»¥äº†ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getcid</span><span class="params">(name, bvid, referer, dirpath)</span>:</span></span><br><span class="line">    Host = <span class="string">'api.bilibili.com'</span></span><br><span class="line">    url = <span class="string">'https://api.bilibili.com/x/player/pagelist?'</span>+<span class="string">'bvid='</span> + bvid +<span class="string">'&amp;jsonp=jsonp'</span></span><br><span class="line">    path = getHTML.get(url=url, name=name, dirpath=dirpath, referer=referer, Host=Host, suffix=<span class="string">'txt'</span>)</span><br><span class="line">    <span class="keyword">return</span> path</span><br></pre></td></tr></table></figure>
<p>getHTMLæ˜¯æˆ‘è‡ªå·±å†™çš„ç”¨äºçˆ¬å–çš„å‡½æ•°ï¼Œå› ä¸ºè¦ç»è¿‡ä¸æ­¢ä¸€æ¬¡çˆ¬å–<br><br>å†…å®¹æ˜¯ï¼š(è¿™æ‰æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„çˆ¬å–)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">import</span> savefile</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(url, name, dirpath=None, referer=None, Host=None, suffix=None)</span>:</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">    <span class="string">'Accept'</span>: <span class="string">'text/html, application/xhtml+xml, application/xml; q=0.9, */*; q=0.8'</span>,</span><br><span class="line">    <span class="string">'Accept-Language'</span>: <span class="string">'zh-Hans-CN, zh-Hans; q=0.5'</span>,</span><br><span class="line">    <span class="string">'DNT'</span>: <span class="string">'1'</span>,</span><br><span class="line">    <span class="string">'Host'</span>: <span class="string">'search.bilibili.com'</span>,</span><br><span class="line">    <span class="string">'Origin'</span>: <span class="string">'https://www.bilibili.com'</span>,</span><br><span class="line">    <span class="string">'Upgrade-Insecure-Requests'</span>: <span class="string">'1'</span>,</span><br><span class="line">    <span class="string">'User-Agent'</span>: <span class="string">'å†™ä¸Šè‡ªå·±çš„useragentï¼Œä¸€ä¸ªç½‘é¡µå³é”®æ£€æŸ¥å…ƒç´ ï¼Œnetworkç½‘ç»œé‡Œéšä¾¿ç‚¹ä¸€ä¸ªåŒ…request headersè¯·æ±‚å¤´é‡Œ'</span>,</span><br><span class="line"></span><br><span class="line">    &#125;<span class="comment"># åˆšå¼€å§‹å°è¯•çš„æ—¶å€™headerså†™çš„å°‘ï¼Œè¢«bç«™å¤§å¤§å°äº†å‡ æ¬¡ipï¼Œè¿˜å¥½bç«™å¤§å¤§ä»æ…ˆï¼Œcookieå¯ä»¥ä¸åŠ ï¼Œå¦‚æœæ˜¯æµè§ˆå™¨æ— ç—•æ¨¡å¼ä¸€èˆ¬æ˜¯ä¸ä¼šå°†cookieåŠ å…¥å¤´çš„ï¼ŒåŠ ä¸Š'DNT':1</span></span><br><span class="line">    <span class="keyword">if</span> referer != <span class="literal">None</span>:</span><br><span class="line">        headers[<span class="string">'referer'</span>] = referer</span><br><span class="line">    <span class="keyword">if</span> Host != <span class="literal">None</span>:</span><br><span class="line">        headers[<span class="string">'Host'</span>] = Host</span><br><span class="line">    req = request.Request(url, headers=headers)</span><br><span class="line">    print(<span class="string">'å¼€å§‹æŠ“å–'</span>)</span><br><span class="line">    response = request.urlopen(req)</span><br><span class="line">    print(<span class="string">'æŠ“å–&#123;&#125;æˆåŠŸ!'</span>.format(url))</span><br><span class="line">    html = response.read()</span><br><span class="line">    html = html.decode(<span class="string">'utf-8'</span>)</span><br><span class="line">    path = savefile.save(name=name, dirpath=dirpath, content=html,suffix=suffix )</span><br><span class="line">    <span class="keyword">return</span> path</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br></pre></td></tr></table></figure>
<p>è·å–çš„cidæ•°æ®æ˜¯jsonæ ¼å¼çš„<br><br>ç”¨jsonæ¨¡å—è¯»å–ï¼Œå¯ä»¥è¿›è¡Œä¸€ç³»åˆ—å­—å…¸ã€åˆ—è¡¨æ“ä½œã€‚<br><img src="/2020/04/28/%E7%88%AC%E8%99%AB%E4%B8%8B%E8%BD%BDb%E7%AB%99%E8%A7%86%E9%A2%91/cid.png" alt><br>å¦‚æœç›´æ¥ç”¨ç…jsonæ–‡æœ¬ç»“æ„ç®€å•è¿˜å¥½ï¼Œç»“æ„å¤æ‚èƒ½ç…ççœ¼ã€‚æˆ‘ç”¨vscodeé‡Œçš„json toolæ’ä»¶ï¼Œå®‰è£…å¹¶é‡å¯åæŒ‰ctrl + alt + må³å¯è¿›è¡Œç»“æ„åŒ–å±•ç¤ºï¼Œæ³¨æ„æ ¼å¼åŒ–å‰ä¸è¦é€‰ä¸­ï¼ˆå°±æ˜¯æµè§ˆæ—¶ç”¨å…‰æ ‡ä¸€ç›´æŒ‰ä½å·¦é”®é€‰å–ï¼Œæ–‡å­—åœ°ä¸‹ä¼šå‡ºç°é˜´å½±ï¼‰ä»»ä½•æ–‡æœ¬ï¼Œä¸ç„¶ä¼šå¤±è´¥ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(cid_file, mode=<span class="string">'r'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f = json.load(f)</span><br></pre></td></tr></table></figure>
<p>å¦‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">f[<span class="string">'data'</span>][<span class="number">0</span>][<span class="string">'cid'</span>]</span><br></pre></td></tr></table></figure>
<p>å€¼å°±æ˜¯145508985ã€‚<br><strong>æ³¨æ„dataè¿™ä¸ªé”®å¯¹åº”çš„å€¼æ˜¯ä¸ªåˆ—è¡¨ï¼Œåˆ—è¡¨é‡Œçš„å…ƒç´ åˆæ˜¯å¾ˆå¤šä¸ªï¼ˆè¿™é‡Œåªæœ‰ä¸€ä¸ªï¼‰å­—å…¸ã€‚</strong><br><br>æœ‰ä¸€äº›è§†é¢‘é‡Œä¸æ­¢æœ‰ä¸€ä¸ªpï¼Œä¸€ä¸ªpå¯¹åº”ä¸€ä¸ªcidã€‚<br><br></p>
<h2 id="1-3è·å–è§†é¢‘url"><a href="#1-3è·å–è§†é¢‘url" class="headerlink" title="1.3è·å–è§†é¢‘url"></a><strong>1.3è·å–è§†é¢‘url</strong><br></h2><p>ç°åœ¨å·²ç»å–å¾—äº†è§†é¢‘çš„bvid,cidå°±èƒ½åˆ©ç”¨è¿™ä¸¤ä¸ªå‚æ•°ä»bç«™api<br></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">'https://api.bilibili.com/x/player/playurl?'</span> + <span class="string">'bvid='</span> + bvid +<span class="string">'&amp;cid='</span> + str(cid) + <span class="string">'&amp;qn=64&amp;type=&amp;otype=json'</span></span><br></pre></td></tr></table></figure>
<p>é‡Œè·å¾—urlï¼Œqu=64æ˜¯è§†é¢‘åˆ†è¾¨ç‡1080pï¼Œ32æ˜¯720pã€‚<br><br>è¿™é‡Œè·å–èµ„æºçš„æ—¶å€™headersé‡ŒHostå€¼æ¢æˆ api.bilibili.com<br><br>refererå€¼æ¢æˆä¹‹å‰å·²ç»è·å–çš„refererï¼Œä¸€èˆ¬ç»“æ„æ˜¯ï¼šâ€<a href="http://www.bilibili.com/video/BV1C7411k7D3?from=search&quot;" target="_blank" rel="noopener">http://www.bilibili.com/video/BV1C7411k7D3?from=search&quot;</a>,<br><br>çˆ¬å–åçš„æ–‡ä»¶æ ¼å¼ä¾æ—§æ˜¯json<br><br><img src="/2020/04/28/%E7%88%AC%E8%99%AB%E4%B8%8B%E8%BD%BDb%E7%AB%99%E8%A7%86%E9%A2%91/2.png" alt><br>è¦æœ‰è€å¿ƒæ»´ä¸€å±‚ä¸€å±‚å‰¥å¼€ï¼ˆæˆ‘æ„¿ä¸€å±‚ä¸€å±‚ä¸€å±‚ä¸€å±‚å‰¥å¼€ä½ çš„å¿ƒ~ğŸµï¼‰</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(cid_file, mode=<span class="string">'r'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f = json.load(f)</span><br><span class="line">    f[<span class="string">'data'</span>][<span class="string">'durl'</span>][<span class="number">0</span>][<span class="string">'url'</span>]<span class="comment"># è¿™ä¸ªå°±æ˜¯ä¸»è¦çš„é‚£ä¸ªurlï¼Œbackupæ˜¯å¤‡ä»½çš„æ„æ€ã€‚</span></span><br></pre></td></tr></table></figure>
<p>durlçš„å€¼æ˜¯ä¸ªåˆ—è¡¨ï¼Œå¦‚æœæ˜¯ä¸ªå¤špè§†é¢‘ï¼Œåˆ—è¡¨é‡Œçš„å…ƒç´ å°±ä¼šæœ‰å¥½å¤šä¸ªã€‚<br></p>
<h2 id="1-4ä¸‹è½½è§†é¢‘"><a href="#1-4ä¸‹è½½è§†é¢‘" class="headerlink" title="1.4ä¸‹è½½è§†é¢‘"></a><strong>1.4ä¸‹è½½è§†é¢‘</strong></h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">download_video</span><span class="params">(url, referer, name, p_dir)</span>:</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">'origin'</span>: <span class="string">'https://www.bilibili.com'</span>,</span><br><span class="line">        <span class="string">'referer'</span>: <span class="string">'è¿˜æ˜¯ä¹‹å‰é‚£ä¸ªreferer'</span>,</span><br><span class="line">        <span class="string">'user-agent'</span>: <span class="string">'è¿˜æ˜¯é‚£ä¸ªuseragent'</span></span><br><span class="line">    &#125;</span><br><span class="line">    headers[<span class="string">'referer'</span>] = referer</span><br><span class="line"></span><br><span class="line">    r = requests.get(url, stream=<span class="literal">True</span>, headers=headers) <span class="comment"># è¿™é‡Œæ˜¯ä¸‹è½½ </span></span><br><span class="line"></span><br><span class="line">    length = float(r.headers[<span class="string">'content-length'</span>])</span><br><span class="line">    f = open(p_dir + <span class="string">'\\'</span> + <span class="string">'&#123;&#125;.&#123;&#125;'</span>.format(name, <span class="string">'flv'</span>), <span class="string">'wb'</span>)</span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    count_tmp = <span class="number">0</span></span><br><span class="line">    time1 = time.time()</span><br><span class="line">    print(url)</span><br><span class="line">    print(<span class="string">'å¼€å§‹ä¸‹è½½&#123;&#125;'</span>.format(url))</span><br><span class="line">    <span class="keyword">for</span> chunk <span class="keyword">in</span> r.iter_content(chunk_size=<span class="number">10240</span>):<span class="comment"># è¿™é‡Œå¼€å§‹æ˜¯è¿›è¡Œåˆ†å—ä¿å­˜ï¼Œå¹¶è®¡æ—¶</span></span><br><span class="line">        <span class="keyword">if</span> chunk:</span><br><span class="line">            f.write(chunk)</span><br><span class="line">            count += len(chunk)</span><br><span class="line">            <span class="keyword">if</span> time.time() - time1 &gt; <span class="number">2</span>:</span><br><span class="line">                p = count / length * <span class="number">100</span></span><br><span class="line">                speed = (count - count_tmp) / <span class="number">1024</span> / <span class="number">1024</span> / <span class="number">2</span></span><br><span class="line">                count_tmp = count</span><br><span class="line">                print(name + <span class="string">': '</span> + <span class="string">'&#123;:.2f&#125;'</span>.format(p) + <span class="string">'%'</span> + <span class="string">' Speed: '</span> + <span class="string">'&#123;:.2f&#125;'</span>.format(speed) + <span class="string">'M/S'</span>)</span><br><span class="line">                time1 = time.time()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">'&#123;&#125;ä¿å­˜å¤±è´¥ï¼'</span>.format(name))</span><br><span class="line">    f.close()</span><br><span class="line">    print(<span class="string">"&#123;0&#125;.&#123;1&#125;ä¿å­˜æˆåŠŸï¼"</span>.format(name, <span class="string">'flv'</span>))</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šéƒ¨åˆ†å°±èƒ½å®ç°ä»æœç´¢åˆ°ä¸‹è½½è§†é¢‘äº†<br><br></p>
<h1 id="2ã€å…¶å®ƒå‡½æ•°"><a href="#2ã€å…¶å®ƒå‡½æ•°" class="headerlink" title="2ã€å…¶å®ƒå‡½æ•°"></a>2ã€å…¶å®ƒå‡½æ•°</h1><h2 id="main-py"><a href="#main-py" class="headerlink" title="main.py"></a>main.py</h2><p>æœ‰äº›å‘½åæ—¶ç»™æˆ‘è‡ªå·±çœ‹çš„ï¼Œçœ‹ä¸æ‡‚æ²¡å…³ç³»ï¼Œ1.4ä»¥ä¸Šå·²ç»éƒ½å®ç°äº†ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> parse</span><br><span class="line"><span class="keyword">import</span> getHTML</span><br><span class="line"><span class="keyword">import</span> creatdir</span><br><span class="line"><span class="keyword">import</span> getPATH</span><br><span class="line"><span class="keyword">import</span> getBvidUrlName</span><br><span class="line"><span class="keyword">import</span> printSelectList</span><br><span class="line"><span class="keyword">import</span> getCid</span><br><span class="line"><span class="keyword">import</span> getPlayurl</span><br><span class="line"><span class="keyword">import</span> download</span><br><span class="line"><span class="keyword">import</span> title</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">title.content()</span><br><span class="line">d_path = getPATH.GetDesktopPath()</span><br><span class="line">name = input(<span class="string">'è¯·è¾“å…¥ä½ æƒ³ä¸‹è½½çš„è§†é¢‘åç§°: '</span>)</span><br><span class="line">print(<span class="string">'æ¡Œé¢è·¯å¾„ä¸ºï¼š&#123;&#125;'</span>.format(d_path))</span><br><span class="line">path = input(<span class="string">'è¾“å…¥ä½ æƒ³ä¿å­˜çš„æ–‡ä»¶å¤¹çš„ç»å¯¹ä½ç½®ï¼ˆè¾“å…¥pè·³è¿‡æ­¤æ­¥éª¤ï¼Œé»˜è®¤è·¯å¾„ä¸ºæ¡Œé¢ï¼‰ï¼š'</span>)</span><br><span class="line"><span class="comment"># ç¼–ç </span></span><br><span class="line">parse_name = parse.quote(name)</span><br><span class="line">search_url = <span class="string">'https://search.bilibili.com/all?keyword='</span> + parse_name</span><br><span class="line"><span class="comment"># åˆ›å»ºæ ¹æ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="keyword">if</span> path != <span class="string">'p'</span>:</span><br><span class="line">    root_dir = creatdir.creat_a_dir(name, path)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    root_dir = creatdir.creat_a_dir(name, d_path)</span><br><span class="line"><span class="comment"># è·å–HTML</span></span><br><span class="line">html_file = getHTML.get(url=search_url, name=name, dirpath=root_dir, suffix=<span class="string">'txt'</span>)</span><br><span class="line"><span class="comment"># æŠ½å–ç¬¦åˆæ¡ä»¶çš„åˆ—å•</span></span><br><span class="line">video_list = getBvidUrlName.getlist(html_file, name, root_dir=root_dir)</span><br><span class="line"><span class="comment"># æ‰“å°åˆ—å•ï¼Œè®©ç”¨æˆ·é€‰æ‹©ï¼Œè·å¾—é€‰æ‹©è§†é¢‘çš„bvidï¼Œåå­—ï¼Œå’Œç½‘å€</span></span><br><span class="line">g_name, bvid, referer = printSelectList.select_list(video_list)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºç”¨æˆ·é€‰æ‹©è§†é¢‘çš„æ–‡ä»¶å¤¹</span></span><br><span class="line">g_dir = creatdir.creat_a_dir(g_name, root_dir)</span><br><span class="line"><span class="comment"># è·å¾—cid</span></span><br><span class="line">cid_file = getCid.getcid(g_name, bvid, referer, g_dir)</span><br><span class="line"><span class="comment"># è·å–è¢«é€‰ä¸­çš„æ‰€æœ‰è§†é¢‘</span></span><br><span class="line">p_name_list, p_dir_list = getPlayurl.getURL(cid_file=cid_file, bvid=bvid, referer=referer, g_dir=g_dir)</span><br><span class="line"><span class="comment"># ä¸‹è½½è§†é¢‘</span></span><br><span class="line">download.get_video(g_dir=g_dir, p_name_list=p_name_list, p_dir_list=p_dir_list, referer=referer)</span><br></pre></td></tr></table></figure>
<p><br><br></p>
<h2 id="ç”¨æ¥åˆ›å»ºæ–‡ä»¶å¤¹çš„å‡½æ•°creatdir-py"><a href="#ç”¨æ¥åˆ›å»ºæ–‡ä»¶å¤¹çš„å‡½æ•°creatdir-py" class="headerlink" title="ç”¨æ¥åˆ›å»ºæ–‡ä»¶å¤¹çš„å‡½æ•°creatdir.py"></a>ç”¨æ¥åˆ›å»ºæ–‡ä»¶å¤¹çš„å‡½æ•°creatdir.py</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">creat_a_dir</span><span class="params">(sname, spath=<span class="string">r'C:\Users\PAN\Desktop'</span>)</span>:</span></span><br><span class="line">    <span class="string">'''åˆ›å»ºä½äºspathçš„åä¸ºsname+å½“åœ°æ—¶é—´çš„æ–‡ä»¶å¤¹ã€‚é»˜è®¤åœ¨æ¡Œé¢ï¼Œè¿”å›æ–‡ä»¶å¤¹çš„ç›®å½•'''</span></span><br><span class="line">    local_time = time.strftime(<span class="string">'%Y-%m-%d-%H-%M-%S'</span>,time.localtime())</span><br><span class="line">    dir_path = spath + <span class="string">'\\'</span> + sname + <span class="string">'-'</span> + local_time</span><br><span class="line">    os.mkdir(dir_path)</span><br><span class="line">    print(<span class="string">'åˆ›å»º &#123;&#125; æˆåŠŸï¼'</span>.format(dir_path))</span><br><span class="line">    <span class="keyword">return</span> dir_path</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    a = creat_a_dir(<span class="string">'å°ç”²é±¼'</span>)</span><br><span class="line">    print(a)</span><br></pre></td></tr></table></figure>
<p><br><br></p>
<h2 id="ç”¨æ¥ä¿å­˜æ–‡ä»¶çš„å‡½æ•°savefile-py"><a href="#ç”¨æ¥ä¿å­˜æ–‡ä»¶çš„å‡½æ•°savefile-py" class="headerlink" title="ç”¨æ¥ä¿å­˜æ–‡ä»¶çš„å‡½æ•°savefile.py"></a>ç”¨æ¥ä¿å­˜æ–‡ä»¶çš„å‡½æ•°savefile.py</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">save</span><span class="params">(name, dirpath, content, suffix=None)</span>:</span></span><br><span class="line">    <span class="string">'''name æ–‡ä»¶åå­—ï¼Œ dirpath ä¿å­˜åœ¨çš„æ–‡ä»¶å¤¹ç›®å½•ï¼Œcontent ä¿å­˜å†…å®¹, suffix åç¼€'''</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> suffix == <span class="string">'json'</span>:</span><br><span class="line">        suffix = <span class="string">'.'</span> + suffix</span><br><span class="line">        path = dirpath + <span class="string">'\\'</span> + name + suffix</span><br><span class="line">        <span class="keyword">with</span> open(path, mode=<span class="string">'a'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> f0:</span><br><span class="line">            json.dump(content, f0)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        suffix = <span class="string">'.'</span> + <span class="string">'txt'</span></span><br><span class="line">        path = dirpath + <span class="string">'\\'</span> + name + suffix</span><br><span class="line">        <span class="keyword">with</span> open(path, mode=<span class="string">'a'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> f1:</span><br><span class="line">            f1.write(content)</span><br><span class="line">    print(<span class="string">'ä¿å­˜ &#123;&#125; æˆåŠŸï¼'</span>.format(path))</span><br><span class="line">    <span class="keyword">return</span> path</span><br></pre></td></tr></table></figure>
<p>å…¶å®jsonæ˜¯ä¸€ç§å¸¦æ ¼å¼çš„æ–‡æœ¬æ–‡ä»¶ã€‚ä¿å­˜æˆtxtæ ¼å¼ï¼Œç”¨jsonæ ¼å¼åŒ–è¯»å–ï¼Œç»“æœæ˜¯ä¸€æ ·çš„ã€‚<br><br>æˆ‘æŠ˜è…¾æ¥æŠ˜è…¾å»ç®—æ˜ç™½äº†ï¼Œåªè¦æ˜¯æ–‡æœ¬ï¼Œç»Ÿä¸€ä¿å­˜txtå°±æ²¡é”™ï¼Œæ–‡æœ¬çš„å†…å®¹æ ¼å¼ä¸ç”¨å¯¼æ¥å¯¼å»ã€‚å…³é”®åœ¨äºç¼–ç è¦ææ¸…æ¥šã€‚</p>
<h1 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h1><p>å¾ˆæ¸…æ¥šï¼Œæœ‰å¾ˆå¤šåœ°æ–¹å¯ä»¥æ”¹è¿›ã€‚<br>å¦‚æœæœ‰æ—¶é—´çš„è¯ä¼šç»§ç»­åšã€‚<br>ä¼˜ç§€çš„ç¨‹åºï¼Œä¹Ÿè¦æœ‰ä¼˜ç§€çš„å¼‚å¸¸å¤„ç†ï¼Œæˆ‘è¿™é‡Œå¹¶æ²¡æœ‰æä»€ä¹ˆå¼‚å¸¸å¤„ç†ã€‚ç¨‹åºå¯æ‰§è¡Œï¼Œä½†æ˜¯æ¯”è¾ƒè„†å¼±ã€‚</p>
]]></content>
      <categories>
        <category>å®æˆ˜</category>
      </categories>
      <tags>
        <tag>pythonçˆ¬è™«</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€pthonçˆ¬è™«ã€‘è±†ç“£è¯„è®ºå…¨çˆ¬å–</title>
    <url>/2020/04/20/%E3%80%90pthon%E7%88%AC%E8%99%AB%E3%80%91%E8%B1%86%E7%93%A3%E8%AF%84%E8%AE%BA%E5%85%A8%E7%88%AC%E5%8F%96/</url>
    <content><![CDATA[<p>@<a href="ç›®å½•">TOC</a></p>
<h1 id="ç”¨åˆ°çš„åº“"><a href="#ç”¨åˆ°çš„åº“" class="headerlink" title="ç”¨åˆ°çš„åº“"></a>ç”¨åˆ°çš„åº“</h1><p>urllib<br>time<br>re<br>os</p>
<h2 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h2><p>ç›´æ¥çˆ¬ç½‘é¡µåªèƒ½è·å¾—çŸ­è¯„ï¼Œé€šè¿‡æŠ“åŒ…ï¼Œæˆ‘å‘ç°æœ‰è±†ç“£æœ‰ä¸ªä¸“é—¨å‚¨å­˜è¯„è®ºçš„åŒ…å«fullã€‚æŠ“ä¸‹æ¥å°±å¥½äº†ã€‚ç”¨urllibé‡Œçš„requestå’Œç›´æ¥ç”¨requestséƒ½ä¸€æ ·ã€‚<br><br><br><br>ä¸€å¥è¯ï¼Œçˆ¬çš„å¥½ä¸å¦‚è—å¾—å¥½ã€‚<br>è—å¾—å¥½ä¸å¦‚ç”¨çš„å¥½ã€‚</p>
<h1 id="æºä»£ç "><a href="#æºä»£ç " class="headerlink" title="æºä»£ç "></a>æºä»£ç </h1><a id="more"></a>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.mkdir(<span class="string">r'C:\Users\***\Desktop\PYhomework\c800'</span>)</span><br><span class="line">search_counts = <span class="number">800</span></span><br><span class="line">url = <span class="string">'https://movie.douban.com/subject/2353023/reviews'</span></span><br><span class="line">headers = &#123;</span><br><span class="line">        <span class="string">'Accept'</span>: <span class="string">'text/html, application/xhtml+xml, application/xml; q=0.9, */*; q=0.8'</span>,</span><br><span class="line">        <span class="string">'Accept-Language'</span>: <span class="string">'zh-Hans-CN, zh-Hans; q=0.5'</span>,</span><br><span class="line">        <span class="string">'Connection'</span>: <span class="string">'Keep-Alive'</span>,</span><br><span class="line">        <span class="string">'Upgrade-Insecure-Requests'</span>: <span class="string">'1'</span>,</span><br><span class="line">        <span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36 Edge/18.18363'</span>&#125;</span><br><span class="line">headers[<span class="string">'Referer'</span>] = <span class="string">'https://movie.douban.com/subject/2353023/'</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">lists = []</span><br><span class="line"><span class="keyword">for</span> count <span class="keyword">in</span> range(<span class="number">0</span>, search_counts, <span class="number">20</span>):</span><br><span class="line">    url = url + <span class="string">"?start="</span> + str(count)</span><br><span class="line">    req = request.Request(url, headers=headers)</span><br><span class="line">    response = request.urlopen(req)</span><br><span class="line">    HTML = response.read()</span><br><span class="line">    HTML = HTML.decode(<span class="string">"utf-8"</span>)</span><br><span class="line">    pattern = re.compile(<span class="string">"&lt;div data-cid=\"(.*)\"&gt;"</span>)</span><br><span class="line">    lists = pattern.findall(HTML) + lists</span><br><span class="line">    <span class="string">'''çˆ¬å–å®é™…è¯„è®º'''</span></span><br><span class="line"></span><br><span class="line">headers[<span class="string">'Host'</span>] = <span class="string">'movie.douban.com'</span></span><br><span class="line">headers[<span class="string">'Sec-Fetch-Dest'</span>] = <span class="string">'document'</span></span><br><span class="line">headers[<span class="string">'Sec-Fetch-Mode'</span>] = <span class="string">'navigate'</span></span><br><span class="line">headers[<span class="string">'Sec-Fetch-Site'</span>] = <span class="string">'none'</span></span><br><span class="line">headers[<span class="string">'Sec-Fetch-User'</span>] = <span class="string">'?1'</span></span><br><span class="line">headers[<span class="string">'Upgrade-Insecure-Requests'</span>] = <span class="string">'1'</span></span><br><span class="line">print(<span class="string">'çˆ¬å–æˆåŠŸï¼'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> id <span class="keyword">in</span> lists:</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line">    url = <span class="string">'https://movie.douban.com/j/review/'</span> + id + <span class="string">'/full'</span></span><br><span class="line">    req = request.Request(url, headers=headers)</span><br><span class="line">    response = request.urlopen(req)</span><br><span class="line">    comment = response.read()</span><br><span class="line">    comment = comment.decode(<span class="string">"utf-8"</span>)</span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">r"C:\Users\***\Desktop\PYhomework\c800\comment%d.txt"</span> % i, mode=<span class="string">"w"</span>, encoding=<span class="string">"utf-8"</span>) <span class="keyword">as</span> c:</span><br><span class="line">        c.write(comment)</span><br><span class="line">        print(<span class="string">"comment%dä¿å­˜æˆåŠŸï¼"</span> % i)</span><br><span class="line">    time.sleep(<span class="number">0</span>)  <span class="comment"># éšç¼˜è®¾ç½®</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">"æŠ“å–å®Œæˆï¼"</span>)</span><br></pre></td></tr></table></figure>
<p>çˆ¬ä¸æˆåŠŸå°±æŠŠè‡ªå·±æµè§ˆå™¨çš„headeræ¢ä¸Šï¼ŒåŠ ä¸Šè‡ªå·±çš„cookieã€‚<br>è·¯å¾„æ¢æˆè‡ªå·±çš„ã€‚</p>
<h1 id="æ•°æ®æ¸…æ´—"><a href="#æ•°æ®æ¸…æ´—" class="headerlink" title="æ•°æ®æ¸…æ´—"></a>æ•°æ®æ¸…æ´—</h1><p>çˆ¬å®Œä¸æ´—ï¼Œè„æ­»ä½ ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">os.mkdir(<span class="string">"c800ok"</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">801</span>):</span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">r"C:\Users\***\Desktop\PYhomework\c800\comment%d.txt"</span> % i, encoding=<span class="string">"utf-8"</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f = f.read()</span><br><span class="line">        start = f.find(<span class="string">",\"html\":\""</span>)</span><br><span class="line">        end = f.find(<span class="string">'\"&#125;'</span>)</span><br><span class="line">        strings = f[start+<span class="number">9</span>: end]</span><br><span class="line">        strings = re.sub(<span class="string">'&lt;br&gt;'</span>, <span class="string">'\n'</span>, strings)</span><br><span class="line">        <span class="comment"># æˆ‘è¿™é‡Œå°±æ˜¯æ‰‹è´±ç»ƒç»ƒæ­£åˆ™æ›¿æ¢</span></span><br><span class="line">        strings = strings.replace(<span class="string">'\\t'</span>, <span class="string">'\n'</span>)</span><br><span class="line">        strings = strings.replace(<span class="string">'&amp;nbsp;'</span>, <span class="string">''</span>)</span><br><span class="line">        <span class="keyword">with</span> open(<span class="string">r'C:\Users\***\Desktop\PYhomework\c800ok\clear_comment%d.txt'</span> % i, mode=<span class="string">"w"</span>, encoding=<span class="string">"utf-8"</span>) <span class="keyword">as</span> fs:</span><br><span class="line">            fs.write(strings)</span><br><span class="line">            print(<span class="string">'å†™å…¥æˆåŠŸï¼'</span>)</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>pythonå®æˆ˜</category>
      </categories>
      <tags>
        <tag>pythonçˆ¬è™«</tag>
      </tags>
  </entry>
  <entry>
    <title>python format()å‡½æ•°</title>
    <url>/2020/04/23/%E3%80%90Python%E3%80%91format()%E6%A0%BC%E5%BC%8F%E5%8C%96%E8%BE%93%E5%87%BA---%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h1 id="ä¸€ã€æ—§å¼-æ ¼å¼åŒ–è¾“å‡º"><a href="#ä¸€ã€æ—§å¼-æ ¼å¼åŒ–è¾“å‡º" class="headerlink" title="ä¸€ã€æ—§å¼ % æ ¼å¼åŒ–è¾“å‡º"></a>ä¸€ã€æ—§å¼ % æ ¼å¼åŒ–è¾“å‡º</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = <span class="string">"a"</span></span><br><span class="line">print(<span class="string">"è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦%c"</span> % a)</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<table>
<thead>
<tr>
<th>æ ¼å¼</th>
<th>è¾“å‡ºæ–¹å¼</th>
</tr>
</thead>
<tbody><tr>
<td>%c</td>
<td>å•å­—ç¬¦</td>
</tr>
<tr>
<td>%s</td>
<td>å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td>%d</td>
<td>åè¿›åˆ¶</td>
</tr>
<tr>
<td>%f</td>
<td>æµ®ç‚¹å‹</td>
</tr>
</tbody></table>
<p><strong>å¤šä¸ªè¾“å‡º</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = <span class="string">"a"</span></span><br><span class="line">b = <span class="string">"string"</span></span><br><span class="line">print(<span class="string">"è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦%cå’Œ ä¸€æ®µå­—ç¬¦ä¸²%s"</span> % (a, b))</span><br></pre></td></tr></table></figure>
<p><strong>ä¿ç•™å°æ•°</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = <span class="number">520.1314666</span></span><br><span class="line">print(<span class="string">"ä¿ç•™å››ä½å°æ•°%.4f"</span> % a)</span><br></pre></td></tr></table></figure>
<h1 id="äºŒã€formatæ ¼å¼åŒ–è¾“å‡º"><a href="#äºŒã€formatæ ¼å¼åŒ–è¾“å‡º" class="headerlink" title="äºŒã€formatæ ¼å¼åŒ–è¾“å‡º"></a>äºŒã€formatæ ¼å¼åŒ–è¾“å‡º</h1><h2 id="å®šä½è¾“å‡º"><a href="#å®šä½è¾“å‡º" class="headerlink" title="å®šä½è¾“å‡º"></a>å®šä½è¾“å‡º</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">first = <span class="string">"äººç”Ÿè‹¦çŸ­"</span></span><br><span class="line">second = <span class="string">"æˆ‘å§‹ç»ˆåœ¨ä½ èº«è¾¹"</span></span><br><span class="line">print(<span class="string">"è™½ç„¶&#123;&#125;,ä½†æ˜¯&#123;&#125;"</span>.format(first, second))</span><br><span class="line"></span><br><span class="line"><span class="meta">@ JYL</span></span><br></pre></td></tr></table></figure>
<p><strong>åœ¨{}ä¸­è¾“å…¥å®šä½</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">first = <span class="string">"äººç”Ÿè‹¦çŸ­"</span></span><br><span class="line">second = <span class="string">"æˆ‘å§‹ç»ˆåœ¨ä½ èº«è¾¹"</span></span><br><span class="line">print(<span class="string">"&#123;1&#125;,å³ä½¿&#123;0&#125;"</span>.format(first, second)</span><br></pre></td></tr></table></figure>
<h2 id="â€œ-â€é«˜çº§è¾“å‡º"><a href="#â€œ-â€é«˜çº§è¾“å‡º" class="headerlink" title="â€œ:â€é«˜çº§è¾“å‡º"></a>â€œ:â€é«˜çº§è¾“å‡º</h2><p><strong>å‚æ•°ä½ç½® : è¾“å‡ºæ–¹æ³•</strong></p>
<h3 id="1ã€æ•°çš„æ ¼å¼"><a href="#1ã€æ•°çš„æ ¼å¼" class="headerlink" title="1ã€æ•°çš„æ ¼å¼"></a>1ã€æ•°çš„æ ¼å¼</h3><p>ä¿ç•™å°æ•°</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">first = <span class="number">520.13146666</span></span><br><span class="line">second = <span class="number">1</span></span><br><span class="line">print(<span class="string">"æˆ‘æƒ³å¯¹ä½ è¯´&#123;0:.4f&#125;"</span>.format(first))<span class="comment"># å†’å·å‰çš„0å¯ä»¥çœç•¥ï¼Œä¿ç•™å››ä½å°æ•°</span></span><br><span class="line">print(<span class="string">"æˆ‘&#123;:.0%&#125;çˆ±ä½ "</span>.format(second))<span class="comment"># %è¾“å‡º</span></span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºç»“æœï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æˆ‘æƒ³å¯¹ä½ è¯´520.1315</span><br><span class="line">æˆ‘100%çˆ±ä½ </span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>æ ¼å¼</th>
<th>è¾“å‡º</th>
</tr>
</thead>
<tbody><tr>
<td>{:b}</td>
<td>äºŒè¿›åˆ¶</td>
</tr>
<tr>
<td>d</td>
<td>åè¿›åˆ¶</td>
</tr>
<tr>
<td>o</td>
<td>å…«è¿›åˆ¶</td>
</tr>
<tr>
<td>x</td>
<td>åå…­è¿›åˆ¶</td>
</tr>
<tr>
<td>%</td>
<td>ç™¾åˆ†åˆ¶ï¼Œå¦‚æ•°å€¼1ä¼šè¢«è¾“å‡ºä½100%</td>
</tr>
<tr>
<td>,</td>
<td>åƒåˆ†å·ï¼Œå¦‚100ï¼Œ000ï¿¥</td>
</tr>
<tr>
<td>e</td>
<td>å¸¦å¹‚ï¼ˆeï¼‰ç¬¦å·è¾“å‡º</td>
</tr>
<tr>
<td>g</td>
<td>ä¸€èˆ¬æ ¼å¼ï¼Œæ•°å­—ä»¥fixed-pointè¿›è¡Œè¾“å‡º,å½“æ•°å€¼ç‰¹åˆ«å¤§çš„æ—¶å€™ï¼Œç”¨å¹‚å½¢å¼æ‰“å°</td>
</tr>
<tr>
<td>n</td>
<td>æ•°å­—ï¼Œå½“å€¼ä¸ºæ•´æ•°æ—¶å’Œâ€dâ€ç›¸åŒï¼Œå€¼ä¸ºæµ®ç‚¹æ•°æ˜¯å’Œâ€gâ€ç›¸åŒï¼Œä¸åŒçš„æ˜¯ä»–ä¼šæ ¹æ®åŒºåŸŸè®¾ç½®æ’å…¥æ•°å­—åˆ†éš”ç¬¦ã€‚</td>
</tr>
<tr>
<td><strong>å¯¹æ•°æ®æœ¬èº«è¿›è¡Œæ“ä½œ</strong></td>
<td></td>
</tr>
<tr>
<td><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">number = <span class="number">520.1314666</span></span><br><span class="line">a = format(number,<span class="string">".4f"</span>)</span><br><span class="line">print(a)</span><br></pre></td></tr></table></figure></td>
<td></td>
</tr>
<tr>
<td>è¾“å‡ºç»“æœ</td>
<td></td>
</tr>
<tr>
<td><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">520.1315 # æ³¨æ„ä¸ºstrç±»å‹</span><br></pre></td></tr></table></figure></td>
<td></td>
</tr>
<tr>
<td>### 2ã€å¯¹é½</td>
<td></td>
</tr>
<tr>
<td><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">first = <span class="string">"æˆ‘çˆ±ä½ "</span></span><br><span class="line">print(<span class="string">"æˆ‘æƒ³å¯¹ä½ è¯´&#123;:&gt;20&#125;"</span>.format(first))</span><br></pre></td></tr></table></figure></td>
<td></td>
</tr>
<tr>
<td>â€œ&gt;â€å·è¡¨ç¤ºå³å¯¹é½ï¼Œ20è¡¨ç¤º<strong>æ€»</strong>è¾“å‡ºé•¿åº¦æ˜¯20å­—ç¬¦ï¼ˆå«ç©ºï¼‰</td>
<td></td>
</tr>
<tr>
<td>è¾“å‡ºç»“æœ</td>
<td></td>
</tr>
<tr>
<td><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æˆ‘æƒ³å¯¹ä½ è¯´                 æˆ‘çˆ±ä½ </span><br></pre></td></tr></table></figure></td>
<td></td>
</tr>
<tr>
<td>æ ¼å¼</td>
<td>å¯¹é½æ–¹å¼</td>
</tr>
<tr>
<td>â€”</td>
<td>â€”</td>
</tr>
<tr>
<td>&lt;</td>
<td>å·¦ï¼ˆé»˜è®¤ï¼‰</td>
</tr>
<tr>
<td>&gt;</td>
<td>å³</td>
</tr>
<tr>
<td>^</td>
<td>å±…ä¸­ï¼ˆå¶æ•°åå·¦ï¼‰</td>
</tr>
<tr>
<td><strong>è‡ªå®šä¹‰å¡«å……</strong></td>
<td></td>
</tr>
<tr>
<td><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">first = <span class="string">"æˆ‘çˆ±ä½ "</span></span><br><span class="line">print(<span class="string">"&#123;:a^20&#125;"</span>.format(first))</span><br></pre></td></tr></table></figure></td>
<td></td>
</tr>
<tr>
<td>è¾“å‡ºä¸ºï¼š</td>
<td></td>
</tr>
<tr>
<td><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">aaaaaaaaæˆ‘çˆ±ä½ aaaaaaaaa</span><br></pre></td></tr></table></figure></td>
<td></td>
</tr>
<tr>
<td>è‡ªå®šä¹‰åŒ–ï¼š</td>
<td></td>
</tr>
<tr>
<td><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">first = <span class="string">"æˆ‘çˆ±ä½ "</span></span><br><span class="line">second = <span class="string">"*"</span></span><br><span class="line">print(<span class="string">"&#123;0:&#123;1&#125;^20&#125;"</span>.format(first, second))</span><br></pre></td></tr></table></figure></td>
<td></td>
</tr>
<tr>
<td>è¾“å‡ºä¸ºï¼š</td>
<td></td>
</tr>
<tr>
<td><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">********æˆ‘çˆ±ä½ *********</span><br></pre></td></tr></table></figure></td>
<td></td>
</tr>
<tr>
<td># ä¸‰ã€å‘å‡½æ•°ä¸­ä¼ å…¥åºåˆ—ï¼ˆé™¤äº†å…ƒç»„ï¼Ÿï¼‰</td>
<td></td>
</tr>
<tr>
<td>ç”¨[]æ¥è®¿é—®å€¼</td>
<td></td>
</tr>
<tr>
<td><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">list = [<span class="string">"æˆ‘çˆ±ä½ "</span>, <span class="string">"ä¸€ç”Ÿä¸€ä¸–"</span>, <span class="string">"ä¸ç¦»ä¸å¼ƒ"</span>, <span class="string">"æ°¸ä¸åˆ†ç¦»"</span>]</span><br><span class="line">print(<span class="string">"&#123;[0]&#125;"</span>.format(list))</span><br><span class="line"><span class="comment"># å…ƒç»„ä¼šæŠ¥é”™</span></span><br><span class="line">list2 = <span class="number">520.1314666</span>, <span class="number">775.852166</span></span><br><span class="line">print(<span class="string">"å› ä¸º&#123;[0]&#125;, æ‰€ä»¥&#123;[1]&#125;"</span>.format(list2))</span><br></pre></td></tr></table></figure></td>
<td></td>
</tr>
<tr>
<td>ä¹Ÿå¯ä»¥è®¿é—®ä¿®æ”¹é”®å€¼</td>
<td></td>
</tr>
<tr>
<td><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">dict = &#123;<span class="string">"a"</span>: <span class="string">"æˆ‘çˆ±ä½ "</span>, <span class="string">"b"</span>: <span class="string">"ä¸€ç”Ÿä¸€ä¸–"</span>, <span class="string">"c"</span>: <span class="string">"ä¸ç¦»ä¸å¼ƒ"</span>&#125;</span><br><span class="line">print(<span class="string">"å› ä¸º&#123;0[a]&#125;, æ‰€ä»¥&#123;0[c]&#125;"</span>.format(dict))</span><br></pre></td></tr></table></figure></td>
<td></td>
</tr>
<tr>
<td>è¾“å‡ºä¸ºï¼š</td>
<td></td>
</tr>
<tr>
<td><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å› ä¸ºæˆ‘çˆ±ä½ , æ‰€ä»¥ä¸ç¦»ä¸å¼ƒ</span><br></pre></td></tr></table></figure></td>
<td></td>
</tr>
<tr>
<td>å¯ä»¥çœ‹å‡º <strong>:å·</strong>å‰å®šä½å‚æ•° ï¼Œæ˜¯å®šä½åæ–¹formatå‡½æ•°ä¸­ä¼ å…¥å¯¹è±¡çš„ä½ç½®ã€‚</td>
<td></td>
</tr>
</tbody></table>
<p><strong>å¦ä¸€ç§æ–¹å¼ï¼Œç›´æ¥ä½¿ç”¨é”®</strong><br>å¯¹è±¡å‰åŠ  **</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">dict = &#123;<span class="string">"a"</span>: <span class="string">"æˆ‘çˆ±ä½ "</span>, <span class="string">"b"</span>: <span class="string">"ä¸€ç”Ÿä¸€ä¸–"</span>, <span class="string">"c"</span>: <span class="string">"ä¸ç¦»ä¸å¼ƒ"</span>&#125;</span><br><span class="line">print(<span class="string">"å› ä¸º&#123;a&#125;, æ‰€ä»¥&#123;c&#125;"</span>.format(**dict))</span><br></pre></td></tr></table></figure>

<p><strong>END</strong></p>
]]></content>
      <categories>
        <category>pythonåŸºç¡€</category>
      </categories>
      <tags>
        <tag>python-formatå‡½æ•°</tag>
      </tags>
  </entry>
  <entry>
    <title>matplotlibè®¾ç½®ä¸­æ–‡</title>
    <url>/2020/04/22/%E3%80%90Python%20%20matplotlib%E3%80%91%E7%AE%80%E5%8D%95%E7%88%AC%E8%99%AB4%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%20%20~%20matplotlib%E8%AE%BE%E7%BD%AE%E4%B8%AD%E6%96%87%E6%98%BE%E7%A4%BA%EF%BC%88pycharm%E8%AE%BE%E7%BD%AE%EF%BC%89%20~%20python%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B02/</url>
    <content><![CDATA[<h1 id="æ€»ç»“ç½‘ä¸Šæ–¹æ³•ï¼Œå¤‡å¿˜"><a href="#æ€»ç»“ç½‘ä¸Šæ–¹æ³•ï¼Œå¤‡å¿˜" class="headerlink" title="æ€»ç»“ç½‘ä¸Šæ–¹æ³•ï¼Œå¤‡å¿˜"></a>æ€»ç»“ç½‘ä¸Šæ–¹æ³•ï¼Œå¤‡å¿˜</h1><p>@<a href="ç›®å½•">TOC</a></p>
<h1 id="ç¬¬â‘ æ­¥-æ‰¾åˆ°ä¸­æ–‡å­—tffæ–‡ä»¶æˆ–ä¸‹è½½"><a href="#ç¬¬â‘ æ­¥-æ‰¾åˆ°ä¸­æ–‡å­—tffæ–‡ä»¶æˆ–ä¸‹è½½" class="headerlink" title="ç¬¬â‘ æ­¥  æ‰¾åˆ°ä¸­æ–‡å­—tffæ–‡ä»¶æˆ–ä¸‹è½½"></a>ç¬¬â‘ æ­¥  æ‰¾åˆ°ä¸­æ–‡å­—tffæ–‡ä»¶æˆ–ä¸‹è½½</h1><h2 id="å¾®è½¯è‡ªå¸¦tffå­—ä½“"><a href="#å¾®è½¯è‡ªå¸¦tffå­—ä½“" class="headerlink" title="å¾®è½¯è‡ªå¸¦tffå­—ä½“"></a>å¾®è½¯è‡ªå¸¦tffå­—ä½“</h2><p>1ã€æ§åˆ¶é¢æ¿â€”&gt;<br>2ã€å¤–è§‚å’Œä¸ªæ€§åŒ–â€”&gt;<br>3ã€å­—ä½“â€”&gt;<br>4ã€å¤åˆ¶.tffæ–‡ä»¶ï¼ˆå¤åˆ¶ä½ æƒ³æ·»åŠ è¿›matplotlibé‡Œçš„ï¼‰</p>
<h2 id="è‡ªå·±ç½‘ä¸Šä¸‹è½½"><a href="#è‡ªå·±ç½‘ä¸Šä¸‹è½½" class="headerlink" title="è‡ªå·±ç½‘ä¸Šä¸‹è½½"></a>è‡ªå·±ç½‘ä¸Šä¸‹è½½</h2><p>å­—ç”±</p>
<h1 id="ç¬¬â‘¡æ­¥-è®¾ç½®matplotlib"><a href="#ç¬¬â‘¡æ­¥-è®¾ç½®matplotlib" class="headerlink" title="ç¬¬â‘¡æ­¥  è®¾ç½®matplotlib"></a>ç¬¬â‘¡æ­¥  è®¾ç½®matplotlib</h1><a id="more"></a>
<p>1ã€æ‰¾åˆ°matplotlibåŒ…çš„ä½ç½®,æ·»åŠ tff<br>å³é”®ä½ çš„pythonå¿«æ·æ–¹å¼ï¼Œæ‰“å¼€æ–‡ä»¶æ‰€åœ¨æ–‡ä»¶å¤¹ï¼Œå¦‚æœæ‰“å¼€åçš„æ–‡ä»¶å¤¹é‡Œè¿˜æ˜¯å¿«æ·æ–¹å¼ç»§ç»­å³é”®æ‰“å¼€æ–‡ä»¶æ‰€åœ¨æ–‡ä»¶å¤¹ã€‚<br>ä¾æ¬¡ç‚¹<br>Lib &gt; site-packages &gt; matplotlib &gt; mpl-data &gt; fonts &gt; tff<br>æŠŠåˆšå¤åˆ¶çš„tffå­—ä½“æ–‡ä»¶æ‰”è¿›å»ã€‚å¹¶å¤åˆ¶ä¸€ä¸‹åå­—ã€‚<br>2ã€è®¾ç½®matplotlibrc<br>Lib &gt; site-packages &gt; matplotlib &gt; mpl-data<br>æœ‰ä¸€ä¸ªmatplotlibrcæ–‡ä»¶ã€‚<br>å³é”®ç”¨è®°äº‹æœ¬æ‰“å¼€<br>æ‰¾åˆ°(æˆ‘çš„åœ¨è®°äº‹æœ¬çš„248è¡Œå’Œ256è¡Œï¼Œç‰ˆæœ¬å®š)<br>åˆ é™¤â€œ#â€å·</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#font.family  : sans-serif</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#font.sans-serif : DejaVu Sans, Bitstream Vera Sans, ...</span></span><br></pre></td></tr></table></figure>
<p>å¹¶æŠŠåˆšå¤åˆ¶çš„æ–‡ä»¶åå­—æ·»åŠ åˆ°ç¬¬äºŒä¸ªé‡Œé¢ï¼Œæˆ‘å¤åˆ¶çš„æ˜¯simsun</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">font.sans-serif :simsun, DejaVu Sans, Bitstream Vera Sans, ...</span><br><span class="line">åˆ«æä¸­æ–‡é€—å·ï¼</span><br></pre></td></tr></table></figure>
<p>è´Ÿå·æ˜¾ç¤ºé”™è¯¯æ”¹ï¼ˆ395è¡Œï¼‰</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#axes.unicode_minus : True</span></span><br></pre></td></tr></table></figure>
<p>æ”¹ä¸ºï¼šå‰åˆ é™¤# åæ”¹False</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">axes.unicode_minus : <span class="literal">False</span></span><br><span class="line">ctrl + s ä¿å­˜</span><br></pre></td></tr></table></figure>
<p>3ã€é‡è½½<br>æ‰“å¼€IDLE</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> matplotlib.font_manager <span class="keyword">import</span> _rebuild</span><br><span class="line">&gt;&gt;&gt;_rebuild</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<h2 id="PS-ç”¨pycharmçš„æ³¨æ„"><a href="#PS-ç”¨pycharmçš„æ³¨æ„" class="headerlink" title="PS:ç”¨pycharmçš„æ³¨æ„"></a>PS:ç”¨pycharmçš„æ³¨æ„</h2><p>ç”¨pycharmçš„ï¼Œè™šæ‹Ÿç¯å¢ƒé‡Œçš„Libä¹Ÿæ”¹ä¸€ä¸‹å§ï¼ˆæ»‘ç¨½ï¼‰<br>æˆ‘æ˜¯åœ¨æ–°å»ºé¡¹ç›®æ—¶<br>ç‚¹å¼€    Project Interpreterï¼šï¼ˆé¡¹ç›®è§£é‡Šè€…ï¼Œæ¬ºè´Ÿæˆ‘çœ‹ä¸æ‡‚è‹±æ–‡è®©æˆ‘å¥½æ‰¾ï¼‰</p>
<p>é€‰ä¸­  inherit global site-packages ï¼ˆç»§æ‰¿å…¨å±€åŒ…ï¼‰</p>
<p>END!</p>
]]></content>
      <categories>
        <category>matploylibåº“</category>
      </categories>
      <tags>
        <tag>matplotlib, è®¾ç½®</tag>
      </tags>
  </entry>
  <entry>
    <title>å°‘å¹´ä¸­å›½è¯´</title>
    <url>/2020/04/22/%E5%B0%91%E5%B9%B4%E4%B8%AD%E5%9B%BD%E8%AF%B4/</url>
    <content><![CDATA[<h1 id="ç”¨æ¥æµ‹è¯•æ˜¾ç¤ºæ•ˆæœ"><a href="#ç”¨æ¥æµ‹è¯•æ˜¾ç¤ºæ•ˆæœ" class="headerlink" title="ç”¨æ¥æµ‹è¯•æ˜¾ç¤ºæ•ˆæœ"></a>ç”¨æ¥æµ‹è¯•æ˜¾ç¤ºæ•ˆæœ</h1><p>ã€Šå°‘å¹´ä¸­å›½è¯´ã€‹ æ¢å¯è¶…</p>
<a id="more"></a>
<center>ã€Šå°‘å¹´ä¸­å›½è¯´ã€‹<center>
<center>æ¢å¯è¶…<center>
<br>
<center>
ä½¿ä¸¾å›½ä¹‹å°‘å¹´è€Œæœä¸ºå°‘å¹´ä¹Ÿï¼Œåˆ™å¾ä¸­å›½ä¸ºæœªæ¥ä¹‹å›½ï¼Œå…¶è¿›æ­¥æœªå¯é‡ä¹Ÿã€‚<br>
ä½¿ä¸¾å›½ä¹‹å°‘å¹´è€Œäº¦ä¸ºè€å¤§ä¹Ÿï¼Œåˆ™å¾ä¸­å›½ä¸ºè¿‡å»ä¹‹å›½ï¼Œå…¶æ¾Œäº¡å¯ç¿˜è¶³è€Œå¾…ä¹Ÿã€‚<br>
æ•…ä»Šæ—¥ä¹‹è´£ä»»ï¼Œä¸åœ¨ä»–äººï¼Œè€Œå…¨åœ¨æˆ‘å°‘å¹´ã€‚
<br>å°‘å¹´æ™ºåˆ™å›½æ™ºï¼Œå°‘å¹´å¯Œåˆ™å›½å¯Œï¼›<br>å°‘å¹´å¼ºåˆ™å›½å¼ºï¼Œå°‘å¹´ç‹¬ç«‹åˆ™å›½ç‹¬ç«‹ï¼›<br>å°‘å¹´è‡ªç”±åˆ™å›½è‡ªç”±ï¼›å°‘å¹´è¿›æ­¥åˆ™å›½è¿›æ­¥ï¼›<br>å°‘å¹´èƒœäºæ¬§æ´²ï¼Œåˆ™å›½èƒœäºæ¬§æ´²ï¼›<br>å°‘å¹´é›„äºåœ°çƒï¼Œåˆ™å›½é›„äºåœ°çƒã€‚<br>çº¢æ—¥åˆå‡ï¼Œå…¶é“å¤§å…‰ã€‚<br>æ²³å‡ºä¼æµï¼Œä¸€æ³»æ±ªæ´‹ã€‚<br>æ½œé¾™è…¾æ¸Šï¼Œé³çˆªé£æ‰¬ã€‚<br>ä¹³è™å•¸è°·ï¼Œç™¾å…½éœ‡æƒ¶ã€‚<br>é¹°éš¼è¯•ç¿¼ï¼Œé£å°˜ç¿•å¼ ã€‚<br>å¥‡èŠ±åˆèƒï¼ŒçŸçŸçš‡çš‡ã€‚<br>å¹²å°†å‘ç¡ï¼Œæœ‰ä½œå…¶èŠ’ã€‚<br>å¤©æˆ´å…¶è‹ï¼Œåœ°å±¥å…¶é»„ã€‚<br>çºµæœ‰åƒå¤ï¼Œæ¨ªæœ‰å…«è’ã€‚<br>å‰é€”ä¼¼æµ·ï¼Œæ¥æ—¥æ–¹é•¿ã€‚<br>ç¾å“‰æˆ‘å°‘å¹´ä¸­å›½ï¼Œä¸å¤©ä¸è€ï¼<br>å£®å“‰æˆ‘ä¸­å›½å°‘å¹´ï¼Œä¸å›½æ— ç–†ï¼<center>
</center></center></center></center></center></center>]]></content>
  </entry>
</search>
